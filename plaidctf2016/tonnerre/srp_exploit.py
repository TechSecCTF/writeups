from Crypto.Hash import SHA256
import binascii

N = 168875487862812718103814022843977235420637243601057780595044400667893046269140421123766817420546087076238158376401194506102667350322281734359552897112157094231977097740554793824701009850244904160300597684567190792283984299743604213533036681794114720417437224509607536413793425411636411563321303444740798477587L
g = 9797766621314684873895700802803279209044463565243731922466831101232640732633100491228823617617764419367505179450247842283955649007454149170085442756585554871624752266571753841250508572690789992495054848L
v = 165674960298677315369642561867883496091624769292792204074150337092614964752287803122621876963359715780971900093578962850132496591192295131510624917204670192364009271723089444839548606533268832368676268405764377988005323809734321470184299186127132537376393324213965008025487569799622831466701444653263068925529L
salt = "d14058efb3f49bd1f1c68de447393855e004103d432fa61849f0e5262d0d9e8663c0dfcb877d40ea6de6b78efd064bdd02f6555a90d92a8a5c76b28b9a785fd861348af8a7014f4497a5de5d0d703a24ff9ec9b5c1ff8051e3825a0fc8a433296d31cf0bd5d21b09c8cd7e658f2272744b4d2fb63d4bccff8f921932a2e81813"

def H(P):
  h = SHA256.new()
  h.update(P)
  return h.hexdigest()

def tostr(A):
  return hex(A)[2:].strip('L')

if __name__ == '__main__':
  A = (((pow(v, N - 2, N) * g) % N) * g) % N
  print(hex(A))

  B = 0xd21bcebbd52920b04054244336f0f27a56ee70457e02c6259c3297219493c2611b140e6f7aa5c2d04a0f20c5966ecbd5a5ac5cdb77ce5a4379f54b092871bb6a726c5099af38ccfecd3edab7d91b27448c58213a4db53a5ef7bec81f82d9f5a9fe1ddb0f60f0ec6d4cbff521b7fd3882be381010fdd451d1c2a3ea5fad553df4
  answer = pow(B - v, 2, N)

  session_key = H(tostr(answer))
  print(H(tostr(B) + session_key))